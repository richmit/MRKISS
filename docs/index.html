<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-09-05 Fri 16:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=1024, initial-scale=1" />
<title>MRKISS Library</title>
<meta name="author" content="Mitch Richling" />
<meta name="description" content="MRKISS Documentation" />
<meta name="keywords" content="RK runge kutta ode ivp" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style>body { width: 95%; margin: 2% auto; font-size: 18px; line-height: 1.4em; font-family: Georgia, serif; color: black; background-color: white; }</style>
<style>body { min-width: 500px; max-width: 1024px; }</style>
<style>h1,h2,h3,h4,h5,h6 { color: #A5573E; line-height: 1em; font-family: Helvetica, sans-serif; }</style>
<style>h1,h2,h3 { line-height: 1.4em; }</style>
<style>h1.title { font-size: 3em; }</style>
<style>.subtitle { font-size: 0.6em; }</style>
<style>h4,h5,h6 { font-size: 1em; }</style>
<style>.org-src-container { border: 1px solid #ccc; box-shadow: 3px 3px 3px #eee; font-family: Lucida Console, monospace; font-size: 80%; margin: 0px; padding: 0px 0px; position: relative; }</style>
<style>.org-src-container>pre { line-height: 1.2em; padding-top: 1.5em; margin: 0.5em; background-color: #404040; color: white; overflow: auto; }</style>
<style>.org-src-container>pre:before { display: block; position: absolute; background-color: #b3b3b3; top: 0; right: 0; padding: 0 0.2em 0 0.4em; border-bottom-left-radius: 8px; border: 0; color: white; font-size: 100%; font-family: Helvetica, sans-serif;}</style>
<style>pre.example { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; font-family: Lucida Console, monospace; font-size: 80%; background: #404040; color: white; display: block; padding: 0em; border: 2px solid black; }</style>
<style>blockquote { margin-bottom: 0.5em; padding: 0.5em; background-color: #FFF8DC; border-left: 2px solid #A5573E; border-left-color: rgb(255, 228, 102); display: block; margin-block-start: 1em; margin-block-end: 1em; margin-inline-start: 5em; margin-inline-end: 5em; } </style>
<style>#content { max-width: 60em; }</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="https://github.com/richmit/MRKISS/"> UP </a>
 |
 <a accesskey="H" href="https://www.mitchr.me/"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">MRKISS Library
<br />
<span class="subtitle">MR RK (Runge-Kutta) KISS (Keep It Super Simple)</span>
</h1>
<table border="2 solid #ccc" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right"><b>Author:</b></td>
<td class="org-left"><i>Mitch Richling</i></td>
</tr>

<tr>
<td class="org-right"><b>Updated:</b></td>
<td class="org-left"><i>2025-09-05 16:54:09</i></td>
</tr>

<tr>
<td class="org-right"><b>Generated:</b></td>
<td class="org-left"><i>2025-09-05 16:54:09</i></td>
</tr>
</tbody>
</table>
<p align="center">
Copyright &copy; 2025 Mitch Richling. All rights reserved.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#voc-def">2. Vocabulary &amp; Definitions</a></li>
<li><a href="#features">3. Features &amp; Requirements</a></li>
<li><a href="#def-method">4. Defining Runge-Kutta Methods in <code>MRKISS</code></a></li>
<li><a href="#predefinedrk">5. Predefined Runge-Kutta Methods in <code>MRKISS</code></a>
<ul>
<li><a href="#def-premethod-stab">5.1. Predefined Non-embedded Methods</a></li>
<li><a href="#def-premethod-etab">5.2. Predefined Embedded Methods</a></li>
</ul>
</li>
<li><a href="#ode-func">6. Providing ODE Equations For Solvers</a></li>
<li><a href="#hi-solvers">7. High Level Solvers</a>
<ul>
<li><a href="#hi-solvers-args">7.1. High Level Solver Common Arguments</a></li>
</ul>
</li>
<li><a href="#lo-solvers">8. Low Level, One Step Solvers</a></li>
<li><a href="#utils">9. Utilities</a></li>
<li><a href="#qs-min">10. Quick Start &#x2013; The Absolute Minimum</a>
<ul>
<li><a href="#qs-min-download">10.1. Getting <code>MRKISS</code></a></li>
<li><a href="#qs-min-examples">10.2. Check Out The Examples</a></li>
</ul>
</li>
<li><a href="#use-mrkiss">11. Using <code>MRKISS</code> In Your Projects</a>
<ul>
<li><a href="#use-makeinc">11.1. Notes about <code>include.mk</code></a></li>
</ul>
</li>
<li><a href="#test-mrkiss">12. <code>MRKISS</code> Testing</a>
<ul>
<li><a href="#test-mrkiss-ref-one-step">12.1. Reference One Step Solvers</a></li>
<li><a href="#test-mrkiss-tab-ok">12.2. Tableau Plausibility Tests</a></li>
<li><a href="#test-mrkiss-homo-tab-ok">12.3. Autonomous Solvers and More Tableau Plausibility Tests</a></li>
<li><a href="#test-mrkiss-short">12.4. Short Stages</a></li>
<li><a href="#test-mrkiss-examples">12.5. Examples Are Tests Too</a></li>
</ul>
</li>
<li><a href="#faq">13. FAQ</a>
<ul>
<li><a href="#faq-name">13.1. What's with the name?</a></li>
<li><a href="#faq-fortran">13.2. Why Fortran</a></li>
<li><a href="#faq-why">13.3. Why did you write another ODE solver when so many good options exist?</a></li>
<li><a href="#faq-others">13.4. Why don't you use package XYZ?</a></li>
<li><a href="#faq-zotero">13.5. What are those zotero links in the references?</a></li>
<li><a href="#faq-samethods">13.6. Are high order RK methods overkill for strange attractors?</a></li>
<li><a href="#faq-need-more">13.7. I need a more comprehensive solution.  Do you have advice?</a></li>
<li><a href="#faq-need-fast">13.8. I need something faster.  Do you have advice?</a></li>
<li><a href="#faq-deps">13.9. It seems like things are used other than Fortran.  Are there really no external dependencies?</a></li>
<li><a href="#faq-rel-head">13.10. What is a "Release"?  How is it different from what's on <code>HEAD</code>?</a></li>
<li><a href="#faq-rel-platforms">13.11. What platforms are known to work?</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-introduction" class="outline-2">
<h2 id="introduction"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-introduction">
<p>
<b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> is a <b>simple</b>, <b>tiny</b> library with <b>zero dependencies</b><a href="#faq-deps">[*</a>] that aims to make it easy to <b>use</b>
and <b>experiment with</b> explicit Runge-Kutta methods.
</p>

<p>
From a feature standpoint this library doesn't do anything you can't find in more comprehensive packages like
<a href="https://www.mitchr.me/SS/tools/index.html#lib-sci">SUNDIALS</a> or <a href="https://www.mitchr.me/SS/tools/index.html#imath-inla">Julia</a>'s
<code>DifferentialEquations.jl</code>; however, it has the rather charming feature of being super simple and self contained.  This makes it ideal for sharing results and
code with others without asking them to recreate my technical computing environment or learn about new software.  It also makes it easy to get things up and
and running quickly when moving to a new supercomputer, cloud, or HPC cluster.
</p>

<p>
Here is a complete example in 23 lines that solves <a href="https://www.mitchr.me/SS/lorenz/index.html">Lorenz's system</a> and generates a CSV file of the results.
</p>

<div class="org-src-container">
<pre class="src src-f90"><span style="color: #00ffff;">program</span> <span style="color: #00fa9a; font-weight: bold;">minimal</span>

  <span style="color: #00ffff;">use</span> :: mrkiss_config,      <span style="color: #00ffff;">only</span>: rk, istats_size
  <span style="color: #00ffff;">use</span> :: mrkiss_solvers_nt,  <span style="color: #00ffff;">only</span>: fixed_t_steps
  <span style="color: #00ffff;">use</span> :: mrkiss_utils,       <span style="color: #00ffff;">only</span>: print_solution
  <span style="color: #00ffff;">use</span> :: mrkiss_erk_kutta_4, <span style="color: #00ffff;">only</span>: a, b, c

  <span style="color: #00ffff;">implicit</span> <span style="color: #63b8ff;">none</span>

  <span style="color: #63b8ff;">real</span>(kind=rk), <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> y_iv(3)  = [1.0_rk, 0.0_rk, 0.0_rk]</span>
  <span style="color: #63b8ff;">real</span>(kind=rk), <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> param(3) = [10.0_rk, 28.0_rk, 8.0_rk/3.0_rk]</span>
  <span style="color: #63b8ff;">real</span>(kind=rk), <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> t_end    = 50.0_rk</span>

  <span style="color: #63b8ff;">real</span>(kind=rk)            ::<span style="color: #7fffd4;"> solution(7, 10000)</span>
  <span style="color: #63b8ff;">integer</span>                  ::<span style="color: #7fffd4;"> status, istats(istats_size)</span>

  <span style="color: #00ffff;">call</span> <span style="color: #00fa9a; font-weight: bold;">fixed_t_steps</span>(status, istats, solution, eq, y_iv, param, a, b, c, t_end_o=t_end)
  <span style="color: #00ffff;">call</span> <span style="color: #00fa9a; font-weight: bold;">print_solution</span>(status, solution, filename_o=<span style="color: #fa8072;">"minimal.csv"</span>)

<span style="color: #00ffff;">contains</span>

  <span style="color: #00ffff;">subroutine</span> <span style="color: #00fa9a; font-weight: bold;">eq</span>(status, dydt, y, param)
    <span style="color: #63b8ff;">integer</span>,          <span style="color: #00ffff;">intent</span>(out) ::<span style="color: #7fffd4;"> status</span>
    <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(out) ::<span style="color: #7fffd4;"> dydt(:)</span>
    <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(in)  ::<span style="color: #7fffd4;"> y(:), param(:)</span>
    dydt = [ param(1)*(y(2)-y(1)), y(1)*(param(2)-y(3))-y(2), y(1)*y(2)-param(3)*y(3) ]
    status = 0
  <span style="color: #00ffff;">end subroutine</span> <span style="color: #00fa9a; font-weight: bold;">eq</span>

<span style="color: #00ffff;">end program</span> <span style="color: #00fa9a; font-weight: bold;">minimal</span>
</pre>
</div>

<p>
You can check out a couple larger examples:
</p>
<ul class="org-ul">
<li><a href="ex_three_body.html">Three Body Problem</a></li>
<li><a href="ex_lorenz.html">Lornez Attracter</a></li>
</ul>

<p>
If you just want to jump in, then take a look at the <a href="#qs-min">Quick Start</a> section.  
</p>
</div>
</div>
<div id="outline-container-voc-def" class="outline-2">
<h2 id="voc-def"><span class="section-number-2">2.</span> Vocabulary &amp; Definitions</h2>
<div class="outline-text-2" id="text-voc-def">
<p>
Before discussing the software, it is best if we define the problem we are solving and fix some definitions and notation &#x2013; notation that is used throughout
the source code and documentation.
</p>

<p>
Please note that the material below deviates from the standard presentation of Runge-Kutta methods and the Butcher tableau.  In particular we dispense with
separate \(\mathbf{b}\) vectors per method, the silly hats, and express most of the computations in terms of linear algebra.  
</p>

<p>
<b>Solving an ODE (Ordinary Differential Equation):</b><br />
</p>
<blockquote>
<p>
We wish to compute values for an unknown function \(\mathbf{y}:\mathbb{R}\rightarrow\mathbb{R}^n\) on some interval \([t_\mathrm{iv}, t_\mathrm{max}]\) given an
initial value \(\mathbf{y}(t_\mathrm{iv})=\mathbf{y_\mathrm{iv}}\) and an implicit equation  involving \(t\), \(\mathbf{y}\), and it's derivatives:
</p>

<p>
\[ \mathbf{y}' =  \mathbf{f}(t, \mathbf{y}) \]
</p>
</blockquote>

<p>
The expression above may be written in component form as:
</p>

<p>
\[ \frac{\mathrm{d}\mathbf{y}}{\mathrm{d}t} =  \mathbf{f}(t, \mathbf{y}) =
  \left[\begin{array}{c}
   \frac{\mathrm{d}y_1}{\mathrm{d}t} \\
   \vdots                            \\
   \frac{\mathrm{d}y_n}{\mathrm{d}t} \\
  \end{array}\right]                                                     =
  \left[\begin{array}{c}
   f_1(t, \mathbf{y}) \\
   \vdots             \\
   f_n(t, \mathbf{y}) \\
  \end{array}\right]                                                     =
  \left[\begin{array}{c}
   f_1(t, [y_1, \cdots, y_n]^\mathrm{T}) \\
   \vdots                                \\
   f_n(t, [y_1, \cdots, y_n]^\mathrm{T}) \\
  \end{array}\right] \]
</p>

<p>
If the function \(\mathbf{f}(t, \mathbf{y}) \) doesn't actually depend on \(t\), then the ODE is said to be Autonomous.
</p>

<p>
We define an \(s\)-stage embedded explicit Runge-Kutta method via a set of coefficients organized into a <i>Butcher tableau</i>:
</p>

<p>
\[ \begin{array}{l|llll}
     c_1              & a_{1,1}  & a_{1,2}  & \dots  & a_{1,s}  \\
     c_2              & a_{2,1}  & a_{2,2}  & \dots  & a_{2,s}  \\
     c_3              & a_{3,1}  & a_{3,2}  & \dots  & a_{3,s}  \\
     \vdots           & \vdots   & \vdots   & \ddots & \vdots   \\
     c_s              & a_{s,1}  & a_{s,2}  & \dots  & a_{s,s}  \\
     \hline                                 
     \rule{0pt}{12pt} & b_{1,1}  & b_{1,2}  & \dots  & b_{1,s}  \\
                      & \vdots   & \vdots   & \ddots & \vdots   \\
                      & b_{m,1}  & b_{m,2}  & \dots  & b_{m,s}  \\
   \end{array} \]
</p>

<p>
We reference the blocks of the tableau as (Note \(\mathbf{b}\) is transposed compared to the tableau):
</p>

<p>
\[ \mathbf{a} = \begin{bmatrix} 
                  a_{1,1}  & a_{1,2}  & \dots  & a_{1,s}  \\
                  a_{2,1}  & a_{2,2}  & \dots  & a_{2,s}  \\
                  a_{3,1}  & a_{3,2}  & \dots  & a_{3,s}  \\
                  \vdots   & \vdots   & \ddots & \vdots   \\
                  a_{s,1}  & a_{s,2}  & \dots  & a_{s,s}  
                \end{bmatrix}  
   \,\,\,\,\,\,\,\,
   \mathbf{c} = \begin{bmatrix} 
                  c_{1}  \\
                  c_{2}  \\
                  c_{3}  \\
                  \vdots \\
                  c_{s}  
                \end{bmatrix}  
   \,\,\,\,\,\,\,\,
   \mathbf{b} = \begin{bmatrix} 
                  b_{1,1}  & \dots  & b_{1,m}  \\
                  b_{2,1}  & \dots  & b_{2,m}  \\
                  b_{3,1}  & \dots  & b_{3,m}  \\
                  \vdots   & \ddots & \vdots   \\
                  b_{s,1}  & \dots  & b_{s,m}  
                \end{bmatrix}  
              = \begin{bmatrix} 
                  \vert          &        & \vert        \\
                  \mathbf{b}_1   & \dots  & \mathbf{b}_m \\
                  \vert          &        & \vert        \\
                \end{bmatrix}  
\]
</p>

<p>
Note we use \(\mathbf{b}_i\) with an index to indicate the \(i\)-th column of the matrix, and \(b_{i,j}\) to indicate the \(i,j\)-th element of the matrix.
</p>

<p>
The word <i>embedded</i> is used to indicate that the tableau actually defines \(m\) Runge-Kutta methods &#x2013; one for each column of \(\mathbf{b}\).  The most common
cases are \(m=1\) and \(m=2\) with the first being most commonly used for simple, fixed step size solvers and second most commonly used for adaptive step size
solvers.
</p>

<p>
We say the overall number of stages for the entire <i>embedded</i> method is \(s\), but the number of stages required for an individual method associated with a
column of \(\mathbf{b}\) might be lower if that column has trailing zeros.  If a column has \(k\) trailing zeros the Runge-Kutta method associated with that
column has\(s-k\) stages.
</p>

<p>
Our goal is to compute values of \(\mathbf{y}(t)\) for \(t\in[t_\mathrm{iv}, t_\mathrm{max}]\).  We are given the value of \(\mathbf{y}(t_\mathrm{iv})\).  So
we define a small, positive value \(\Delta{t}\in\mathbb{R}\), and attempt to find \(\mathbf{\Delta{y}}\) such that
\(\mathbf{y}(t_\mathrm{iv})+\mathbf{\Delta{y}}\approx\mathbf{y}(t_\mathrm{iv}+\Delta{t})\).
</p>

<p>
We begin by defining an \(s\times s\) matrix \(\mathbf{k}\):
</p>

<p>
\[ \mathbf{a} = \begin{bmatrix} 
                  k_{1,1}  & k_{1,2}  & \dots  & k_{1,s}  \\
                  k_{2,1}  & k_{2,2}  & \dots  & k_{2,s}  \\
                  k_{3,1}  & k_{3,2}  & \dots  & k_{3,s}  \\
                  \vdots   & \vdots   & \ddots & \vdots   \\
                  k_{s,1}  & k_{s,2}  & \dots  & k_{s,s}  
                \end{bmatrix}  
              = \begin{bmatrix} 
                  \vert          &        & \vert        \\
                  \mathbf{k}_1   & \dots  & \mathbf{k}_s \\
                  \vert          &        & \vert        \\
                \end{bmatrix}  
\]
</p>

<p>
Using
</p>

<p>
\[ \mathbf{k}_i = \mathbf{f}\left(t + c_i \Delta{t},\, \mathbf{y} + \Delta{t} \mathbf{k}_{1..s,1..i} \mathbf{a}_{1..i,1..i}  \right) \]
</p>

<p>
Explicit methods, which are the focus of <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b>, have \(c_1=0\) and \(a_{ij}=0\) for \(i\le j\).  Therefore
\(\mathbf{k}_1 = \mathbf{f}(t,\, \mathbf{y})\), and each subsequent \(\mathbf{k}\) value may be computed in sequence.
</p>

<p>
Each column of \(\mathbf{k}\mathbf{b}\) forms a \(\mathbf{\Delta{y}}\) we can use to approximate \(\mathbf{y}(t_\mathrm{iv}+\Delta{t})\):
</p>

<p>
\[ \mathbf{k}\mathbf{b} = \begin{bmatrix} 
                            \vert                 &        & \vert                \\
                            \mathbf{\Delta{y}}_1  & \dots  & \mathbf{\Delta{y}}_m \\
                            \vert                 &        & \vert                \\
                          \end{bmatrix}  
\]
</p>

<p>
If we use \(\mathbf{\Delta{y}}_1\) to approximate \(\mathbf{y}(t_\mathrm{iv}+\Delta{t})\), then we can use \(\mathbf{\Delta{y}}_2\) to approximate
the error like this:
</p>

<p>
\[\vert\mathbf{\Delta{y}}_1 - \mathbf{\Delta{y}}_2 \vert\]
</p>

<p>
We say that a Runge-Kutta method is of order \(p\in\mathbb{Z_+}=\{i\in\mathbb{Z}\,\,\vert\,\,i>0\}\) if the error at each step is on the order of
\(\mathcal{O}(\Delta{t}^{p+1})\) and the accumulated error of multiple steps is of order \(\mathcal{O}(\Delta{t}^{p})\).  This abuse of big-O terminology is
traditionally also extended to an abuse of big-O notation by saying the Runge-Kutta method is \(\mathcal{O}(p)\).
</p>
</div>
</div>
<div id="outline-container-features" class="outline-2">
<h2 id="features"><span class="section-number-2">3.</span> Features &amp; Requirements</h2>
<div class="outline-text-2" id="text-features">
<p>
<b>The IVPs I work with are generally pretty well behaved</b>
</p>

<ul class="org-ul">
<li>Non-stiff</li>
<li>Time forward (\(\Delta{t} \ge 0\))</li>
<li>Defined by a small (&lt;50) set of equations expressible in closed form.</li>
</ul>

<p>
Typical examples are strange attractors and systems related to chaotic science models from celestial/classical mechanics, population dynamics, oscillating
chemical reactions, and electronic circuits.  My motivation for solving IVPs generally revolve around <i>generative art</i> and <i>visualization</i>.  You will actually
see this in the code and feature set of the library.
</p>

<p>
<b>Things I care about</b>
</p>

<ul class="org-ul">
<li>Simple to use for simple problems.</li>
<li>Graceful response to evaluation failure in derivative functions</li>
<li>A good selection of predefined RK methods</li>
<li>Standard, adaptive step solver with programmable step processing:</li>
<li>Easy deployment &amp; sharing
<ul class="org-ul">
<li>Easy to compile and tune for a new hardware architectures.</li>
<li>Zero external dependencies<a href="#faq-deps">[*</a>] except a Fortran compiler.</li>
<li>100% standard Fortran that works with various compilers.</li>
<li>Simple text output that can be compressed and sent back home or shared with others.</li>
</ul></li>
<li>Runge-Kutta Research
<ul class="org-ul">
<li>Try out new RK methods by simply feeding the solvers a Butcher tableau.</li>
<li>Directly accessible one step routines for assembling custom solvers.</li>
<li>Simple code flow to facilitate instrumentation and deep runtime analysis and reporting.</li>
<li>Individual access to each method in an embedded tableau, and control over how each is used.</li>
<li>Machine readable butcher tableau data and Maple worksheets to process that data.</li>
<li>A few of the RK methods included are of historical or research interest &#x2013; not necessarily very practical.</li>
</ul></li>
<li>Generative art and visualization functionality
<ul class="org-ul">
<li>Solutions include derivative values for visualization tools.</li>
<li>Programmable step processing tuned for visualization problems.
<ul class="org-ul">
<li>Stopping integration.  Examples:
<ul class="org-ul">
<li>If the solution curve is too long in \(\mathbf{y}\)-space</li>
<li>If the step delta, or some components of it, are too long in \(\mathbf{y}\)-space</li>
<li>If the solution has returned to the IV</li>
<li>If the solution intersects itself</li>
</ul></li>
<li>Provide an alternate \(\Delta{t}\) and redo the step based on some condition.</li>
<li>Trigger a bisection search for a \(\Delta{t}\) fitting some condition based on t-space and/or \(\mathbf{y}\)-space.  Examples:
<ul class="org-ul">
<li>Find \(\Delta{t}\) so that \(\Delta{\mathbf{y}}\), or some components of it, are the perfect length.</li>
<li>Find where a step crosses over a boundary in space  (ex: root finding)</li>
<li>Find where a step approaches closest to a point (ex: like the problem's IV)</li>
</ul></li>
</ul></li>
<li>Easy to use, hardwired methods for <i>fixed step size</i> visualization use cases:
<ul class="org-ul">
<li>Fixed \(t\) step size solvers</li>
<li>Fixed \(\mathbf{y}\) step size solver with hard bounds on length error</li>
<li>Fixed \(\mathbf{y}\) step size solver with soft bounds on length error</li>
</ul></li>
<li>Interpolate entire solutions to new time points (Hermite &amp; linear).</li>
</ul></li>
</ul>

<p>
<b>Things that may weird you out</b>
</p>

<p>
Derivative function computation dominates the compute time for many applications.  This observation has had tremendous influence on the development of IVP
numerical techniques and related software.  For the IVPs we are interested in the derivative functions are quite simple and the Runge-Kutta computations
themselves generally dominate the computation time.  This changes things quite dramatically.  For example, techniques like embedded polynomial schemes for
intrastep interpolation designed to minimize function evaluation may actually perform worse than simply making more Runge-Kutta steps for our problems!  As
another example, performing iterative algorithms, like bisection, directly on the Runge-Kutta method itself is quite practical.  Keeping this in mind will
reduce the number of "<i>WTH?!?!</i>" moments you have while reading the code, and will keep you from applying some features, like <code>fixed_y_steps()</code>, to
problems that <b>do</b> have difficult derivatives to compute.
</p>

<p>
While <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a> provides comprehensive support for detecting and forwarding runtime errors, it doesn't do much
<i>programmer</i> error checking.  For example, the code doesn't double check that the programmer has provided appropriate arguments for routines.
</p>
</div>
</div>
<div id="outline-container-def-method" class="outline-2">
<h2 id="def-method"><span class="section-number-2">4.</span> Defining Runge-Kutta Methods in <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></h2>
<div class="outline-text-2" id="text-def-method">
<p>
In <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> explicit Runge-Kutta methods are specified by directly providing the Butcher tableau via arguments to
subroutines.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Type</th>
<th scope="col" class="org-left">Shape</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>a</code></td>
<td class="org-left">The \(\mathbf{a}\) matrix.</td>
<td class="org-left">Real</td>
<td class="org-left">rank 2</td>
</tr>

<tr>
<td class="org-left"><code>b</code></td>
<td class="org-left">The \(\mathbf{b}\) matrix.</td>
<td class="org-left">Real</td>
<td class="org-left">rank 2</td>
</tr>

<tr>
<td class="org-left"><code>c</code></td>
<td class="org-left">The \(\mathbf{c}\) vector.</td>
<td class="org-left">Real</td>
<td class="org-left">rank 2</td>
</tr>

<tr>
<td class="org-left"><code>p</code></td>
<td class="org-left">The order of each embedded method</td>
<td class="org-left">Integer</td>
<td class="org-left">rank 1</td>
</tr>

<tr>
<td class="org-left"><code>se</code></td>
<td class="org-left">Number of steps for each embedded method</td>
<td class="org-left">Integer</td>
<td class="org-left">rank 1</td>
</tr>

<tr>
<td class="org-left"><code>s</code></td>
<td class="org-left">Overall number of steps for the entire tableau</td>
<td class="org-left">Integer</td>
<td class="org-left">scalar</td>
</tr>

<tr>
<td class="org-left"><code>m</code></td>
<td class="org-left">The number of embedded methods</td>
<td class="org-left">Integer</td>
<td class="org-left">scalar</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-predefinedrk" class="outline-2">
<h2 id="predefinedrk"><span class="section-number-2">5.</span> Predefined Runge-Kutta Methods in <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></h2>
<div class="outline-text-2" id="text-predefinedrk">
<p>
<b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> provides several predefined methods in modules found in the
"<a href="https://github.com/richmit/MRKISS/blob/master/lib"><code>MRKISS/lib/</code></a>" directory.  Each module defines a single tableau via parameters with names mirroring
the Butcher Tableau arguments documented in the <a href="#def-method">previous section</a>.  
</p>

<p>
The modules follow a simple naming conventions:
</p>
<ul class="org-ul">
<li>They have one of two prefixes.  <b><code>mrkiss_eerk_</code></b> for <i>embedded</i> and <b><code>mrkiss_erk_</code></b> for non-embedded.</li>
<li>The names end with underscore separated integers indicating the orders of the first two methods.</li>
</ul>

<p>
In addition to the parameters, the comments in these files normally include at least the following three sections:
</p>
<dl class="org-dl">
<dt><code>IMO</code></dt><dd>Personal commentary about the method in question.  Please note this material is simply my personal opinion.</dd>
<dt><code>Known Aliases</code></dt><dd>These include names used in the literature as well as names in some common ODE software.</dd>
<dt><code>References</code></dt><dd>I try to include the original reference if I have it.  I also frequently include discussions found in other texts.</dd>
</dl>

<p>
To make all this concrete, here is what one of these modules looks like (<code>mrkiss_erk_kutta_4.f90</code>):
</p>

<div class="org-src-container">
<pre class="src src-f90"><span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; Butcher tableau for the classic 4 stage Runge-Kutta method of O(4)</span>
<span style="color: #ffa500;">!!</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">IMO: Useful for low accuracy applications; however, I find I rarely use it.</span>
<span style="color: #ffa500;">!!</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">Known Aliases: 'RK4' (OrdinaryDiffEq.jl), 'RK41' (Butcher), &amp; 'The Runge-Kutta Method'.</span>
<span style="color: #ffa500;">!!</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">@image html erk_kutta_4-stab.png</span>
<span style="color: #ffa500;">!!</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">@par Stability Image Links</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">&lt;a href="erk_kutta_4-stab.png"&gt;  &lt;img src="erk_kutta_4-stab.png"  width="256px"&gt; &lt;/a&gt;</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">&lt;a href="erk_kutta_4-astab.png"&gt; &lt;img src="erk_kutta_4-astab.png" width="256px"&gt; &lt;/a&gt;</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">&lt;a href="erk_kutta_4-star1.png"&gt; &lt;img src="erk_kutta_4-star1.png" width="256px"&gt; &lt;/a&gt;</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">&lt;a href="erk_kutta_4-star2.png"&gt; &lt;img src="erk_kutta_4-star2.png" width="256px"&gt; &lt;/a&gt;</span>
<span style="color: #ffa500;">!!</span>
<span style="color: #ffa500;">!! </span><span style="color: #ff7f24;">@par References:</span>
<span style="color: #ffa500;">!!  </span><span style="color: #ff7f24;">- Kutta (1901); Beitrag Zur N\"herungsweisen Integration Totaler Differentialgleichungen; Z. Math. Phys. 46; p435-53</span>
<span style="color: #ffa500;">!!  </span><span style="color: #ff7f24;">- Hairer, Norsett &amp; Wanner (2009). Solving Ordinary Differential Equations. I: Nonstiff Problems. p138; </span>
<span style="color: #ffa500;">!!    </span><span style="color: #ff7f24;">zotero://select/items/0_VLZWN2CT</span>
<span style="color: #ffa500;">!!  </span><span style="color: #ff7f24;">- Butcher (2016); Numerical Methods for Ordinary Differential Equations. 3ed; p102</span>
<span style="color: #ffa500;">!!</span>
<span style="color: #00ffff;">module</span> <span style="color: #00fa9a; font-weight: bold;">mrkiss_erk_kutta_4</span>
  <span style="color: #00ffff;">use</span> <span style="color: #00fa9a; font-weight: bold;">mrkiss_config</span>, <span style="color: #00ffff;">only</span>: rk
  <span style="color: #00ffff;">implicit</span> <span style="color: #63b8ff;">none</span>
  <span style="color: #00ffff;">public</span>
  <span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; The order of the overall method</span>
  <span style="color: #63b8ff;">integer</span>,          <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> s      = 4</span>
  <span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; Number of methods</span>
  <span style="color: #63b8ff;">integer</span>,          <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> m      = 1</span>
  <span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; The @f$\mathbf{a}@f$ matrix for the Butcher Tableau. @hideinitializer @showinlinesource</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> a(s,s) = reshape([ 0.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,  </span><span style="color: #00ffff;">&amp;</span>
<span style="color: #7fffd4;">       </span>&amp;                                            1.0_rk, 0.0_rk, 0.0_rk, 0.0_rk,  <span style="color: #00ffff;">&amp;</span>
       &amp;                                            0.0_rk, 1.0_rk, 0.0_rk, 0.0_rk,  <span style="color: #00ffff;">&amp;</span>
       &amp;                                            0.0_rk, 0.0_rk, 2.0_rk, 0.0_rk], [s, s]) / 2.0_rk
  <span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; The @f$\mathbf{b}@f$ matrix for the Butcher Tableau. @hideinitializer @showinlinesource</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> b(s,m) = reshape([ 1.0_rk, 2.0_rk, 2.0_rk, 1.0_rk], [s, m]) / 6.0_rk</span>
  <span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; The @f$\mathbf{c}@f$ matrix for the Butcher Tableau. @hideinitializer @showinlinesource</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> c(s)   = [         0.0_rk, 1.0_rk, 1.0_rk, 2.0_rk]          / 2.0_rk</span>
  <span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; The method orders</span>
  <span style="color: #63b8ff;">integer</span>,          <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> p(m)   = [4]</span>
  <span style="color: #ffa500;">!</span><span style="color: #ff7f24;">&gt; Number of stages for each method</span>
  <span style="color: #63b8ff;">integer</span>,          <span style="color: #00ffff;">parameter</span> ::<span style="color: #7fffd4;"> se(m)  = [4]</span>
<span style="color: #00ffff;">end module</span> <span style="color: #00fa9a; font-weight: bold;">mrkiss_erk_kutta_4</span>
</pre>
</div>


<p>
Also note all the zeros.  KISS!  Seriously, it takes up a tiny bit of extra space and simplifies the code considerably&#x2026;
</p>

<p>
Each embedded method defines at least two Runge-Kutta methods.  Normally the first two methods are used in conjunction to simultaneously estimate the solution
and the error.  In this library, first method is recommended for approximating the solution while the second method should be used to estimate error.  This is
a recommendation, and is in no way enforced by the library.  When the higher order method is used for the solution, we say we are using <i>local extrapolation</i>.
Note that each of the methods in an embedded Butcher tableau may be used individually as a non-embedded method.
</p>

<p>
In addition to the module files, each tableau may be found in the
"<a href="https://github.com/richmit/MRKISS/blob/master/rk_methods_maple"><code>MRKISS/rk_methods_maple/</code></a>" directory along with several Maple worksheets to manipulate
them.  The filenames mirror the names of the modules.
</p>

<p>
I use <b>BOO</b> to mean <i>Best Of Order</i>.  When used with two integers it is for an embedded method.  I use <b>RC</b> to indicate a method is a <i>Release Candidate</i> &#x2013;
i.e. it may well become a future <b>BOO</b>.  Not the contents of the <b>Status</b> columns are simply <i>my personal opinion</i> based on my experience.  <b><code>YMMV</code></b>
</p>
</div>
<div id="outline-container-def-premethod-stab" class="outline-3">
<h3 id="def-premethod-stab"><span class="section-number-3">5.1.</span> Predefined Non-embedded Methods</h3>
<div class="outline-text-3" id="text-def-premethod-stab">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-left" />

<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Module Name</th>
<th scope="col" class="org-center">Order</th>
<th scope="col" class="org-center">Stages</th>
<th scope="col" class="org-center">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>mrkiss_erk_euler_1</code></td>
<td class="org-center">1</td>
<td class="org-center">1</td>
<td class="org-center">BOO(1)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_midpoint_2</code></td>
<td class="org-center">2</td>
<td class="org-center">2</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_ralston_2</code></td>
<td class="org-center">2</td>
<td class="org-center">2</td>
<td class="org-center">BOO(2)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_ralston_3</code></td>
<td class="org-center">3</td>
<td class="org-center">3</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erkknoth_wolke_3</code></td>
<td class="org-center">3</td>
<td class="org-center">3</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_ralston_4</code></td>
<td class="org-center">4</td>
<td class="org-center">4</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_kutta_4</code></td>
<td class="org-center">4</td>
<td class="org-center">4</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_kutta_three_eight_4</code></td>
<td class="org-center">4</td>
<td class="org-center">4</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_nystrom_5</code></td>
<td class="org-center">5</td>
<td class="org-center">6</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_erk_feagin_10</code></td>
<td class="org-center">10</td>
<td class="org-center">17</td>
<td class="org-center">RC BOO(10)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-def-premethod-etab" class="outline-3">
<h3 id="def-premethod-etab"><span class="section-number-3">5.2.</span> Predefined Embedded Methods</h3>
<div class="outline-text-3" id="text-def-premethod-etab">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" align="center">


<colgroup>
<col  class="org-left" />

<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Module Name</th>
<th scope="col" class="org-center">Ord_1</th>
<th scope="col" class="org-center">Ord_2</th>
<th scope="col" class="org-center">Stages</th>
<th scope="col" class="org-center">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>mrkiss_eerk_heun_euler_2_1</code></td>
<td class="org-center">2</td>
<td class="org-center">1</td>
<td class="org-center">2</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_bogacki_shampine_3_2</code></td>
<td class="org-center">3</td>
<td class="org-center">2</td>
<td class="org-center">4</td>
<td class="org-center">BOO(3,2)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_fehlberg_4_5</code></td>
<td class="org-center">4</td>
<td class="org-center">5</td>
<td class="org-center">6</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_sofroniou_spaletta_4_3</code></td>
<td class="org-center">4</td>
<td class="org-center">3</td>
<td class="org-center">5</td>
<td class="org-center">BOO(4,3)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_cash_karp_5_4</code></td>
<td class="org-center">5</td>
<td class="org-center">4</td>
<td class="org-center">6</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_bogacki_shampine_4_5</code></td>
<td class="org-center">4</td>
<td class="org-center">5</td>
<td class="org-center">7</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_dormand_prince_5_4</code></td>
<td class="org-center">5</td>
<td class="org-center">4</td>
<td class="org-center">7</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_tsitouras_arkode_5_4</code></td>
<td class="org-center">5</td>
<td class="org-center">4</td>
<td class="org-center">7</td>
<td class="org-center">BOO(5,4) &amp; BOO(5)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_verner_1978_6_5</code></td>
<td class="org-center">6</td>
<td class="org-center">5</td>
<td class="org-center">8</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_verner_2010_6_5</code></td>
<td class="org-center">6</td>
<td class="org-center">5</td>
<td class="org-center">9</td>
<td class="org-center">BOO(6,5) &amp; BOO(6)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_verner_7_6</code></td>
<td class="org-center">7</td>
<td class="org-center">6</td>
<td class="org-center">10</td>
<td class="org-center">BOO(7,6) &amp; BOO(7)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_fehlberg_7_8</code></td>
<td class="org-center">7</td>
<td class="org-center">8</td>
<td class="org-center">13</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_dormand_prince_7_8</code></td>
<td class="org-center">7</td>
<td class="org-center">8</td>
<td class="org-center">13</td>
<td class="org-center">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_verner_8_7</code></td>
<td class="org-center">8</td>
<td class="org-center">7</td>
<td class="org-center">13</td>
<td class="org-center">BOO(8,7) &amp; BOO(8)</td>
</tr>

<tr>
<td class="org-left"><code>mrkiss_eerk_verner_9_8</code></td>
<td class="org-center">9</td>
<td class="org-center">8</td>
<td class="org-center">16</td>
<td class="org-center">BOO(9,8) &amp; BOO(9)</td>
</tr>
</tbody>
</table>

<p>
<b>Ord_1</b> is the order of the method used for the solution while <b>Ord_2</b> is the order used for error estimation.  
<b>Stages</b> column is the maximum number of stages for each embedded method.
</p>
</div>
</div>
</div>
<div id="outline-container-ode-func" class="outline-2">
<h2 id="ode-func"><span class="section-number-2">6.</span> Providing ODE Equations For Solvers</h2>
<div class="outline-text-2" id="text-ode-func">
<p>
The equation to be solved is implemented in a user provided subroutine with one of the following two signatures:
</p>

<p>
For Non-autonomous (with t) problems (found in the module <code>mrkiss_solvers_wt</code>):
</p>
<div class="org-src-container">
<pre class="src src-f90"><span style="color: #00ffff;">subroutine</span> <span style="color: #00fa9a; font-weight: bold;">deq_iface</span>(status, dydt, t, y, param) <span style="color: #ffa500;">! </span><span style="color: #ff7f24;">Non-Autonomous Case (with t)</span>
  <span style="color: #63b8ff;">integer</span>,          <span style="color: #00ffff;">intent</span>(out) ::<span style="color: #7fffd4;"> status</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(out) ::<span style="color: #7fffd4;"> dydt(:)</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(in)  ::<span style="color: #7fffd4;"> t</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(in)  ::<span style="color: #7fffd4;"> y(:)</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(in)  ::<span style="color: #7fffd4;"> param(:)</span>
</pre>
</div>

<p>
For Autonomous (no t) problems (found in the module <code>mrkiss_solvers_nt</code>)::
</p>
<div class="org-src-container">
<pre class="src src-f90"><span style="color: #00ffff;">subroutine</span> <span style="color: #00fa9a; font-weight: bold;">deq_iface</span>(status, dydt, y, param)    <span style="color: #ffa500;">! </span><span style="color: #ff7f24;">Autonomous Case (no t)</span>
  <span style="color: #63b8ff;">integer</span>,          <span style="color: #00ffff;">intent</span>(out) ::<span style="color: #7fffd4;"> status</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(out) ::<span style="color: #7fffd4;"> dydt(:)</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(in)  ::<span style="color: #7fffd4;"> y(:)</span>
  <span style="color: #63b8ff;">real</span>(kind=rk),    <span style="color: #00ffff;">intent</span>(in)  ::<span style="color: #7fffd4;"> param(:)</span>
</pre>
</div>

<p>
The arguments are as follows:
</p>
<div class="org-src-container">
<pre class="src src-text">status ........ A status code. A positive value indicates failure.
                Do not return a value larger than 255!
dydt .......... The value of for f(t, y) is returned in this argument
t ............. The time (only for deq_iface_wt)
y ............. Values for the dependent variables
param ......... Constant parameters
</pre>
</div>

<p>
This function should return the value for \( \mathbf{f}(t, \mathbf{y}) \) in <code>dydt</code>.  The value of <code>status</code> should be non-positive, \((-\infty, 0]\), if
everything worked, and a value between 1 and 255 inclusive, \([1, 255]\), if something went wrong.  This value will be passed back via the <code>status</code> argument
of higher level routines to indicate an error condition.
</p>
</div>
</div>
<div id="outline-container-hi-solvers" class="outline-2">
<h2 id="hi-solvers"><span class="section-number-2">7.</span> High Level Solvers</h2>
<div class="outline-text-2" id="text-hi-solvers">
<dl class="org-dl">
<dt><code>adaptive_steps()</code> uses traditional adaptive step size</dt><dd><ul class="org-ul">
<li>This solver is similar to solvers found in other ODE packages.</li>
<li>It provides somewhat finer control over step size adjustment than is typical.</li>
<li>Programmable step processing is used to steer the algorithm instead of directly providing solution points.</li>
<li>A programmable bisection option to solve for interesting \(\Delta{t}\) values.</li>
<li>End precisely on a \(t\) value or when a maximum \(t\) is exceeded.</li>
</ul></dd>
<dt><code>fixed_t_steps()</code> uses fixed \(\Delta{t}\) steps</dt><dd><ul class="org-ul">
<li>With most modern ODE packages, this would be done with a "dense output" mode using embedded interpolation.</li>
<li>This is a good place to start when writing a custom solver.</li>
<li>Common use cases: 
<ul class="org-ul">
<li>Curve evolution animations that naturally display velocity.</li>
</ul></li>
</ul></dd>
<dt><code>fixed_y_steps()</code> uses fixed \(\Delta{\mathbf{y}}\)-space steps</dt><dd><ul class="org-ul">
<li>Produce solution points separated by fixed distance in \(\Delta{\mathbf{y}}\)-space.</li>
<li>The components of \(\Delta{\mathbf{y}}\) used for length computations may be specified.</li>
<li>Overall curve length is computed allowing exit options based on total solution length.</li>
<li>This is a good place to start when writing a custom solver with a bisection step.</li>
<li>With most modern ODE packages, this would be done with interpolation.  Usually in combination with a step processing routine.</li>
<li>This could be achieved in <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b>  with the programmable step processing and bisection features of <code>adaptive_steps()</code>.</li>
<li>Common use cases: 
<ul class="org-ul">
<li>Parametric line/dot plots</li>
<li>Tube plots and sphere sweeps.</li>
</ul></li>
</ul></dd>
<dt><code>sloppy_fixed_y_steps()</code> adjusts \(\Delta{t}\) to <b>approximate</b> \(\Delta{\mathbf{y}}\)-space steps</dt><dd><ul class="org-ul">
<li>Much like <code>fixed_y_steps()</code> in practice but faster and less precise.</li>
<li>Computes a test step and then adjusts \(\Delta{t}\) in proportion to the ratio of the desired length vs test length.</li>
<li>This method has no guarantee for correctness, but generally works well in practice.</li>
<li>Can operate on every step or just steps that are too long.  This allows for two handy behaviors:
<ul class="org-ul">
<li>A cheap kind of steps size error control</li>
<li>A way to bound the overall length of \(\Delta{\mathbf{y}}\)</li>
</ul></li>
<li>Common use cases: 
<ul class="org-ul">
<li><code>fixed_t_steps()</code> results have a few steps that are "too long"</li>
<li>Additional error control for systems with one or two "hot" coordinates.</li>
</ul></li>
</ul></dd>
<dt><code>fixed_t_steps_between()</code> takes a set of \(t\) values at which to find solutions</dt><dd><ul class="org-ul">
<li>Uses several fixed Runge-Kutta steps to go from each \(t\) value to the next.</li>
<li>Common use cases: 
<ul class="org-ul">
<li>Produce a higher accuracy solution based on a previous solution.</li>
<li>Physical problems requiring solutions at specific time points.</li>
</ul></li>
</ul></dd>
<dt><code>interpolate_solution</code> interpolates an existing solution to a new solution</dt><dd><ul class="org-ul">
<li>Not a Runge-Kutta method; however, it provides \(\mathcal{O}(3)\) accuracy when using Hermite interpolation.</li>
<li>Derivative values are freshly computed for the interpolated points</li>
<li>Common use cases: 
<ul class="org-ul">
<li>Produce smooch plots from distant solution points.</li>
<li>To "line up" two solutions to the same set of \(t\) values.</li>
</ul></li>
</ul></dd>
</dl>
</div>
<div id="outline-container-hi-solvers-args" class="outline-3">
<h3 id="hi-solvers-args"><span class="section-number-3">7.1.</span> High Level Solver Common Arguments</h3>
<div class="outline-text-3" id="text-hi-solvers-args">
<p>
The solvers share some common arguments.
</p>
</div>
<div id="outline-container-hi-solvers-args-status" class="outline-4">
<h4 id="hi-solvers-args-status"><span class="section-number-4">7.1.1.</span> Status: <code>status</code> &amp; <code>istats</code></h4>
<div class="outline-text-4" id="text-hi-solvers-args-status">
<p>
The first two arguments of all high level solvers are:
</p>

<dl class="org-dl">
<dt><code>status</code></dt><dd>This is an integer return code.  
<ul class="org-ul">
<li>A positive value means failure.</li>
<li>Usually <code>0</code> is returned for success; however, negative values are also acceptable.</li>
<li>Each routine has a well defined block of positive status values assigned to it.</li>
<li>The documentation for each routine details possible positive status return values.</li>
<li>See: <code>status_to_origin()</code>  &amp; <code>status_to_message()</code> in the <a href="#utils">Utilities section</a></li>
</ul></dd>
<dt><code>istats</code></dt><dd>Statistics regarding the solver run.</dd>
</dl>
<div class="org" id="org292c323">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Computed solution points</td>
<td class="org-left">istats( 1)</td>
</tr>

<tr>
<td class="org-left">step_one call count not caused by an event</td>
<td class="org-left">istats( 2)</td>
</tr>

<tr>
<td class="org-left">step_all call count not caused by an event</td>
<td class="org-left">istats( 3)</td>
</tr>

<tr>
<td class="org-left">step_one call count caused by y_delta error constraint</td>
<td class="org-left">istats( 4)</td>
</tr>

<tr>
<td class="org-left">step_all call count caused by y_delta error constraint</td>
<td class="org-left">istats( 5)</td>
</tr>

<tr>
<td class="org-left">step_one call count caused by y_delta length constraint</td>
<td class="org-left">istats( 6)</td>
</tr>

<tr>
<td class="org-left">step_one call count caused by step processing with new t_delta</td>
<td class="org-left">istats( 7)</td>
</tr>

<tr>
<td class="org-left">step_one call count caused by SDF bisection</td>
<td class="org-left">istats( 8)</td>
</tr>

<tr>
<td class="org-left">Bisection failures due to max_bisect_o</td>
<td class="org-left">istats( 9)</td>
</tr>

<tr>
<td class="org-left">Bisection failures due to target containment</td>
<td class="org-left">istats(10)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="outline-container-hi-solvers-args-sol" class="outline-4">
<h4 id="hi-solvers-args-sol"><span class="section-number-4">7.1.2.</span> The Solution: <code>solution</code></h4>
<div class="outline-text-4" id="text-hi-solvers-args-sol">
<p>
The third argument of all high level solvers.
</p>

<dl class="org-dl">
<dt><code>solution</code></dt><dd>Array for solution.  <br />
<ul class="org-ul">
<li>Each <b>column</b> is a solution containing \(t\), \(\mathbf{y}\), and \(\mathbf{y'}\).</li>
<li>The first column contains \(t\).</li>
<li>The coordinates of \(\mathbf{y}\) start in column <code>2</code>.</li>
<li>The coordinates \(\mathbf{y'}\) begin immediately after the coordinates of \(\mathbf{y}\).</li>
</ul></dd>
</dl>
</div>
</div>
<div id="outline-container-hi-solvers-args-ivp" class="outline-4">
<h4 id="hi-solvers-args-ivp"><span class="section-number-4">7.1.3.</span> The IVP: <code>deq</code>, <code>t</code>, <code>y</code>, <code>param</code></h4>
<div class="outline-text-4" id="text-hi-solvers-args-ivp">
<p>
After the solution argument, the next arguments describe the IVP itself.
</p>

<dl class="org-dl">
<dt><code>deq</code>  </dt><dd>The subroutine used to evaluate the derivative function</dd>
<dt><code>t</code>    </dt><dd>The initial value for \(t\) for non-autonomous problems (i.e. when using <code>mrkiss_solvers_wt</code>)</dd>
<dt><code>y</code>    </dt><dd>The initial value for \(\mathbf{y}\).</dd>
<dt><code>param</code></dt><dd>A set of real values passed to <code>deq()</code>.  These are usually constants in the defining equation.</dd>
</dl>
</div>
</div>
<div id="outline-container-hi-solvers-args-tab" class="outline-4">
<h4 id="hi-solvers-args-tab"><span class="section-number-4">7.1.4.</span> The Butcher Tableau</h4>
<div class="outline-text-4" id="text-hi-solvers-args-tab">
<p>
These arguments vary a bit, but mirror the names documented in the <a href="#def-method">section on predefined Runge-Kutta methods</a>.
</p>
</div>
</div>
<div id="outline-container-hi-solvers-args-other" class="outline-4">
<h4 id="hi-solvers-args-other"><span class="section-number-4">7.1.5.</span> Other Arguments</h4>
<div class="outline-text-4" id="text-hi-solvers-args-other">
<p>
These arguments are used by multiple, but not all, high level solvers:
</p>

<dl class="org-dl">
<dt><code>max_bisect_o</code>                 </dt><dd>Maximum number of bisection iterations per each step.  Default: <code>max_bisect_ai</code></dd>
<dt><code>max_pts_o</code>                    </dt><dd>Maximum number of solutions to store.  Default: Number of rows in solution</dd>
<dt><code>no_bisect_error_o</code>            </dt><dd>If <code>.true.</code>, then not exit on bisection errors.  Default: <code>.false.</code></dd>
<dt><code>t_delta_min_o</code>                </dt><dd>Minimum \(\Delta{t}\). Default: <code>t_delta_ai</code></dd>
<dt><code>t_end_o</code>                      </dt><dd>Try to stop integration precisely on this \(t\) value. Default: NONE</dd>
<dt><code>t_max_o</code>                      </dt><dd>Stop integration if \(t\) exceeds this value.  Default: NONE</dd>
<dt><code>y_delta_len_idxs_o</code>           </dt><dd>Components of \(\Delta{\mathbf{y}}\) to use for length.  Default: All components</dd>
<dt><code>y_delta_len_targ</code>             </dt><dd>Target length for \(\Delta{\mathbf{y}}\)</dd>
<dt><code>y_sol_len_max_o</code>              </dt><dd>Stop integration if solution length exceeds this value</dd>
<dt><code>t_delta_max</code> &amp; <code>t_delta_max_o</code></dt><dd>Maximum allowed \(\Delta{t}\). Default: NONE</dd>
</dl>
</div>
</div>
</div>
</div>
<div id="outline-container-lo-solvers" class="outline-2">
<h2 id="lo-solvers"><span class="section-number-2">8.</span> Low Level, One Step Solvers</h2>
<div class="outline-text-2" id="text-lo-solvers">
<p>
Behind all of the above high level solvers are single step routines to carry out the step calculations.  These are handy for creating DIY solvers.  
</p>

<ul class="org-ul">
<li>Generic RK methods: 
<ul class="org-ul">
<li><code>step_one()</code> &#x2013; Use the <b>first</b> RK method in a tableau, returning \(\Delta{\mathbf{y}}\) as a <b>vector</b>.</li>
<li><code>step_all()</code> &#x2013; Use <b>every</b> RK method in a tableau, returning \(\Delta{\mathbf{y}}\) values as columns in a <b>matrix</b> .</li>
</ul></li>
<li>Hardwired RK methods (used mostly for unit tests):
<ul class="org-ul">
<li><code>step_one_rk4()</code>: Corresponds to <code>mrkiss_erk_kutta_4</code>. Returns a single \(\Delta{\mathbf{y}}\) as a <b>vector</b>.</li>
<li><code>step_one_rkf45()</code>: Corresponds to <code>mrkiss_eerk_fehlberg_4_5</code>, Returns a two \(\Delta{\mathbf{y}}\) values as columns of a <b>matrix</b>.</li>
<li><code>step_one_dp54()</code>: Corresponds to <code>mrkiss_eerk_dormand_prince_5_4</code>. Returns a two \(\Delta{\mathbf{y}}\) values as columns of a <b>matrix</b>.</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-utils" class="outline-2">
<h2 id="utils"><span class="section-number-2">9.</span> Utilities</h2>
<div class="outline-text-2" id="text-utils">
<p>
<b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> provides a few utilities:
</p>

<ul class="org-ul">
<li>Output
<ul class="org-ul">
<li><code>print_solution()</code> Print a solution to a file or STDOUT.</li>
<li><code>print_istats()</code> Print an <code>istats</code> array to a file or STDOUT.</li>
</ul></li>
<li>Miscellaneous
<ul class="org-ul">
<li><code>analyze_solution()</code> Compute statistics related to the solution and print the results to STDOUT.</li>
<li><code>seq()</code> Compute a fixed delta sequence of values in the same way steps are computed in <code>fixed_t_steps()</code></li>
</ul></li>
<li>Status Codes
<ul class="org-ul">
<li><code>status_to_origin()</code> Returns the subroutine or interface name assigned the given status code</li>
<li><code>status_to_message()</code> Returns the error message for the given status code</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-qs-min" class="outline-2">
<h2 id="qs-min"><span class="section-number-2">10.</span> Quick Start &#x2013; The Absolute Minimum</h2>
<div class="outline-text-2" id="text-qs-min">
<p>
If you are interested playing around with <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> as quickly as possible, then this section is for you.
</p>
</div>
<div id="outline-container-qs-min-download" class="outline-3">
<h3 id="qs-min-download"><span class="section-number-3">10.1.</span> Getting <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></h3>
<div class="outline-text-3" id="text-qs-min-download">
<p>
The first step is to download <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b>.  The easiest way is to clone it with git:
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone <span style="color: #fa8072;">'https://github.com/richmit/MRKISS.git'</span>
</pre>
</div>

<p>
Alternately, you could download the zip file: <a href="https://github.com/richmit/MRKISS/archive/refs/heads/master.zip">MRKISS</a>
</p>
</div>
</div>
<div id="outline-container-qs-min-examples" class="outline-3">
<h3 id="qs-min-examples"><span class="section-number-3">10.2.</span> Check Out The Examples</h3>
<div class="outline-text-3" id="text-qs-min-examples">
<p>
The newly cloned repository will contain a directory called "<a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a>".  
Change into the <a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a> directory.  
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b0c4de;">cd</span> MRKISS/examples
</pre>
</div>
</div>
<div id="outline-container-qs-min-makefile" class="outline-4">
<h4 id="qs-min-makefile"><span class="section-number-4">10.2.1.</span> Setting up make to build an example</h4>
<div class="outline-text-4" id="text-qs-min-makefile">
<p>
<b>Note:</b> You can probably skip this entire section if you are are using <code>gfprtran</code> on linux, a mac, or MSYS2 in Windows.
</p>

<p>
The <a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a> directory contains a <code>makefile</code> used to build all the examples.  At the top
of the makefile you will find something like this:
</p>

<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #ffa500;">###############################################################</span>
<span style="color: #7fffd4;">MRKISS_PATH</span> = ..

<span style="color: #7fffd4;">DO_OPENMP</span> = NO

 <span style="color: #00ffff;">include</span> $(<span style="color: #7fffd4;">MRKISS_PATH</span>)/make_includes/tools_gfortran.mk
<span style="color: #ffa500;"># </span><span style="color: #ff7f24;">include $(</span><span style="color: #7fffd4;">MRKISS_PATH</span><span style="color: #ff7f24;">)/make_includes/tools_flang.mk</span>
<span style="color: #ffa500;"># </span><span style="color: #ff7f24;">include $(</span><span style="color: #7fffd4;">MRKISS_PATH</span><span style="color: #ff7f24;">)/make_includes/tools_ifx.mk</span>

<span style="color: #00ffff;">include</span> $(<span style="color: #7fffd4;">MRKISS_PATH</span>)/make_includes/include.mk
<span style="color: #ffa500;">###############################################################</span>
</pre>
</div>

<p>
If you want to use a different compiler, then you may be able to simply uncomment the appropriate line if your system is similarly configured to mine.  If you
are unlucky, then you may need to set some variables.  In particular, you might need to comment out the <code>gfortran</code> include and add something like this:
</p>

<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #7fffd4;">AR</span> := ar
<span style="color: #7fffd4;">FC</span> := nvfortran
<span style="color: #7fffd4;">FFLAGS</span> := -O3 -Wall -W -Xlinker -z -Xlinker execstack
<span style="color: #7fffd4;">FSHFLG</span> = -o $(<span style="color: #7fffd4;">MRKISS_SHARED_LIB_FILE</span>) -shared $(<span style="color: #7fffd4;">MRKISS_OBJ_FILES</span>)
</pre>
</div>

<p>
The only tricky one is the <code>FSHFLG</code> variable.  Luckily you only need the <code>FSHFLG</code> variable if you plan on building a shared library.  The shared library is
completely unnecessary for making full use of the modules, so you you can safely ignore that one unless you really, really want to use a shared library. <code>;)</code>
</p>
</div>
</div>
<div id="outline-container-qs-min-examples-build" class="outline-4">
<h4 id="qs-min-examples-build"><span class="section-number-4">10.2.2.</span> Build An Example</h4>
<div class="outline-text-4" id="text-qs-min-examples-build">
<p>
Once you have the <code>makefile</code> worked out, pick an example to build.  For example, we might try this one:
<a href="https://github.com/richmit/MRKISS/blob/master/examples/lorenz.f90"><code>lorenz.f90</code></a>.
</p>

<div class="org-src-container">
<pre class="src src-sh">make lorenz
</pre>
</div>

<p>
Assuming the build worked, we can now run the code.  On UNIX systems the binary will be called <code>lorenz</code> and on Windows it will be called <code>lorenz.exe</code>.  On
Windows running it looks like this:
</p>

<div class="org-src-container">
<pre class="src src-sh">./lorenz.exe
</pre>
</div>

<p>
That's not very interesting.  The fun part is what it did in the background.  The program should produce a file called <code>lorenz.csv</code> that has the solution
curve.  If you have GNU Plot, you can graph it with something like this:
</p>

<div class="org-src-container">
<pre class="src src-sh">gnuplot -p &lt; lorenz.gplt
</pre>
</div>


<div id="org7d07af4" class="figure">
<p><a href="pics/lorenz.png" width="90%" align="center"><img src="pics/lorenz.png" alt="lorenz.png" width="90%" align="center" /></a>
</p>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-use-mrkiss" class="outline-2">
<h2 id="use-mrkiss"><span class="section-number-2">11.</span> Using <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a> In Your Projects</h2>
<div class="outline-text-2" id="text-use-mrkiss">
<p>
All of the code is in the module source files with no external dependencies at all.  So you just need to call the modules from your code, and then
compile/link everything together.
</p>

<p>
You can do that by just listing all the source files on the command line with most Fortran compilers.  For example, we could compile the
<a href="https://github.com/richmit/MRKISS/blob/master/examples/lorenz.f90"><code>lorenz.f90</code></a> example in the
<a href="https://github.com/richmit/MRKISS/blob/master/examples/"><code>MRKISS/examples/</code></a> directly like this:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b0c4de;">cd</span> examples
gfortran.exe lorenz.f90 ../src/*.f90
</pre>
</div>

<p>
That said, most people will probably want to use a build system.  If GNU Make is your thing, then the files in the
<a href="https://github.com/richmit/MRKISS/blob/master/make_include/"><code>/MRKISS/make_include/</code></a> directory may be of help.  In particular the makefile fragment
<a href="https://github.com/richmit/MRKISS/blob/master/make_include/include.mk"><code>include.mk</code></a> provides useful targets and variables.  The makefile in the
<a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a> directory is a good guide on how to use
<a href="https://github.com/richmit/MRKISS/blob/master/include.mk"><code>include.mk</code></a>.  In essence you do the following in your makefile:
</p>

<ol class="org-ol">
<li>Set MRKISS_PATH in your makefile to the path of the <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> source directory &#x2013; that's the one with the <code>include.mk</code> file.</li>
<li>Set FC, FFLAGS, &amp; AR if necessary &#x2013; most of the time you can use the defaults.</li>
<li>Include the "<a href="https://github.com/richmit/MRKISS/blob/master/make_include/include.mk"><code>include.mk</code></a>" file in the <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> source directory.</li>
<li>Add a build rule for your program.</li>
</ol>

<p>
Your makefile will look something like this:
</p>

<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #7fffd4;">MRKISS_PATH</span> = ../MRKISS

<span style="color: #ffa500;"># </span><span style="color: #ff7f24;">Set FC, FFLAGS, &amp; AR here.  The include below has the settings I use on my system.</span>
<span style="color: #00ffff;">include</span> $(<span style="color: #7fffd4;">MRKISS_PATH</span>)/tools_gfortran.mk

<span style="color: #00ffff;">include</span> $(<span style="color: #7fffd4;">MRKISS_PATH</span>)/include.mk

<span style="color: #00fa9a; font-weight: bold;">your_program</span> : your_program.f90 $(<span style="color: #7fffd4;">MRKISS_OBJ_FILES</span>)
    $(<span style="color: #7fffd4;">FC</span>) $(<span style="color: #7fffd4;">FFLAGS</span>) $<span style="color: #8470ff; font-weight: bold;">^</span> -o <span style="color: #00fa9a; font-weight: bold;">$</span><span style="color: #8470ff; font-weight: bold;">@</span>
</pre>
</div>

<p>
Note the rule for <code>your_program</code> in the makefile above takes the lazy approach of adding every <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> module as a
dependency regardless of if your program actually needs them all.  This is how most people use the modules because it's simple.  The cost might be a couple
seconds of extra compile time.  You can explicitly list out the modules in the makefile if you wish.  Such a rule might look like the following:
</p>

<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #00fa9a; font-weight: bold;">your_program</span> : your_program.f90 mrkiss_config$(<span style="color: #7fffd4;">OBJ_SUFFIX</span>) mrkiss_solvers_wt(OBJ_SUFFIX) mrkiss_utils$(<span style="color: #7fffd4;">OBJ_SUFFIX</span>)
    $(<span style="color: #7fffd4;">FC</span>) $(<span style="color: #7fffd4;">FFLAGS</span>) $<span style="color: #8470ff; font-weight: bold;">^</span> -o <span style="color: #00fa9a; font-weight: bold;">$</span><span style="color: #8470ff; font-weight: bold;">@</span>
</pre>
</div>
</div>
<div id="outline-container-use-makeinc" class="outline-3">
<h3 id="use-makeinc"><span class="section-number-3">11.1.</span> Notes about <code>include.mk</code></h3>
<div class="outline-text-3" id="text-use-makeinc">
</div>
<div id="outline-container-makeinc-names" class="outline-4">
<h4 id="makeinc-names"><span class="section-number-4">11.1.1.</span> Names of files</h4>
<div class="outline-text-4" id="text-makeinc-names">
<dl class="org-dl">
<dt>File extensions on Windows (outside of WSL)</dt><dd><ul class="org-ul">
<li>Executable files use <code>.exe</code></li>
<li>Shared libraries use <code>.dll</code></li>
<li>Object files will <code>.obj</code></li>
</ul></dd>
<dt>On UNIX systems (not including MSYS2)</dt><dd><ul class="org-ul">
<li>Executable files have no extension</li>
<li>Shared libraries use <code>.so</code></li>
<li>Object files will use <code>.o</code></li>
</ul></dd>
</dl>
</div>
</div>
<div id="outline-container-makeinc-vars" class="outline-4">
<h4 id="makeinc-vars"><span class="section-number-4">11.1.2.</span> Useful Variables</h4>
<div class="outline-text-4" id="text-makeinc-vars">
<dl class="org-dl">
<dt><code>MRKISS_MOD_FILES</code>      </dt><dd>All the module (<code>.mod</code>) files.  These will appear in your build directory.</dd>
<dt><code>MRKISS_OBJ_FILES</code>      </dt><dd>All the object (<code>.obj</code> or <code>.o</code>) files.  These will appear in your build directory.</dd>
<dt><code>MRKISS_STATIC_LIB_FILE</code></dt><dd>The name of the static library file.  It's not created by default.  It will appear in your build directory if it is listed as a dependency on one of your targets.</dd>
<dt><code>MRKISS_SHARED_LIB_FILE</code></dt><dd>The name of the shared library file.  It's not created by default.  It will appear in your build directory if it is listed as a dependency on one of your targets.</dd>
</dl>
</div>
</div>
<div id="outline-container-makeinc-target" class="outline-4">
<h4 id="makeinc-target"><span class="section-number-4">11.1.3.</span> Useful Targets</h4>
<div class="outline-text-4" id="text-makeinc-target">
<dl class="org-dl">
<dt><code>all_mrkiss_lib</code>    </dt><dd>Builds the library files.</dd>
<dt><code>all_mrkiss_mod</code>    </dt><dd>Builds the module (<code>.mod</code>) files</dd>
<dt><code>all_mrkiss_obj</code>    </dt><dd>Builds the object (<code>.obj</code> or <code>.o</code>) files</dd>
<dt><code>clean_mrkiss_mod</code>  </dt><dd>Deletes all the <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> module (<code>.mod</code>) files in the build directory.</dd>
<dt><code>clean_mrkiss_obj</code>  </dt><dd>Deletes all the <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> object (<code>.obj</code> or <code>.o</code>) files in the build directory.</dd>
<dt><code>clean_mrkiss_lib</code>  </dt><dd>Deletes all the library files in the build directory.</dd>
<dt><code>clean_mrkiss</code>      </dt><dd>Simply calls the following targets: <code>clean_mrkiss_mod</code>, <code>clean_mrkiss_obj</code>, &amp; <code>clean_mrkiss_lib</code></dd>
<dt><code>clean_multi_mrkiss</code></dt><dd>The previous clean targets will only remove products from the current platform.  For example, the <code>clean_mrkiss_obj</code> target will
delete object files with an extension of <code>.obj</code> on windows and an extension of <code>.o</code> on UNIX'ish platforms.  I use the same directories to
build for all platforms, so I sometimes want to clean up the build products from all platforms at once.  That's what this target will do.</dd>
</dl>
</div>
</div>
<div id="outline-container-makeinc-stlib" class="outline-4">
<h4 id="makeinc-stlib"><span class="section-number-4">11.1.4.</span> Static Library</h4>
<div class="outline-text-4" id="text-makeinc-stlib">
<p>
A rule to make a static library is included in <code>include.mk</code>.  A build rule like the following should build that library and link it to your executable.  Note
I'm just including the library file on the command line instead of linker like options (i.e. <code>-L</code> and <code>-l</code> for GNU compilers).  That's because simply including
the library on the command line is broadly supported across more compilers &#x2013; this way I don't have to document how to do the same thing for each one. ;)
</p>

<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #00fa9a; font-weight: bold;">your_program</span> : your_program.f90 $(<span style="color: #7fffd4;">MRKISS_STATIC_LIB_FILE</span>)
    $(<span style="color: #7fffd4;">FC</span>) $(<span style="color: #7fffd4;">FFLAGS</span>) $<span style="color: #8470ff; font-weight: bold;">^</span> $(<span style="color: #7fffd4;">MRKISS_STATIC_LIB_FILE</span>) -o <span style="color: #00fa9a; font-weight: bold;">$</span><span style="color: #8470ff; font-weight: bold;">@</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-makeinc-dylib" class="outline-4">
<h4 id="makeinc-dylib"><span class="section-number-4">11.1.5.</span> Dynamic Library (<code>.so</code> and <code>.dll</code> files)</h4>
<div class="outline-text-4" id="text-makeinc-dylib">
<p>
A rule to make a static library is included in <code>include.mk</code>.  You can build it with the target <code>clean_mrkiss_lib</code>, or by using <code>$(MRKISS_SHARED_LIB_FILE)</code> as a
dependency in your build rule.  As the options to link to a shared library differ wildly across platforms and compilers/linkers, I don't provide an example of
how to do that.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-test-mrkiss" class="outline-2">
<h2 id="test-mrkiss"><span class="section-number-2">12.</span> <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a> Testing</h2>
<div class="outline-text-2" id="text-test-mrkiss">
<p>
This section is about how I test <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a>.  
</p>

<p>
The <a href="https://github.com/richmit/MRKISS/blob/master/tests"><code>MRKISS/tests/</code></a> directory contains code I primary use for testing
<a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a> while the <a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a> directory contains
code I primarily use to demonstrate how to use <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a>.  The difference between a "test" and an "example" in
<a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a> is a little bit slippery.  Some of the tests, like <code>tc1_*</code> and <code>tc2_*</code>, could be considered demonstrations.
In addition, I use all of the code in <a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a> for tests.
</p>

<p>
The tests can be run by changing into the appropriate directory (<a href="https://github.com/richmit/MRKISS/blob/master/tests"><code>MRKISS/tests/</code></a> or
<a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a>), and building the make target <code>tests</code>.  For example:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b0c4de;">cd</span> tests
make -j 16 tests
</pre>
</div>

<p>
Note the <code>-j 16</code> argument to make.  When running all the tests, especially in the <a href="https://github.com/richmit/MRKISS/blob/master/tests"><code>MRKISS/tests/</code></a>
directory, I strongly recommend running in parallel.
</p>

<p>
In addition, the make files in <a href="https://github.com/richmit/MRKISS/blob/master/tests"><code>MRKISS/tests/</code></a> and
<a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a> have numerous additional targets to run various individual tests or subsets of
the test suite.  These targets are documented in the subsections below.
</p>
</div>
<div id="outline-container-test-mrkiss-ref-one-step" class="outline-3">
<h3 id="test-mrkiss-ref-one-step"><span class="section-number-3">12.1.</span> Reference One Step Solvers</h3>
<div class="outline-text-3" id="text-test-mrkiss-ref-one-step">
<p>
The production solvers in <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a> all consume Butcher tableaux in the <code>mrkiss_erk*</code> and <code>mrkiss_eerk*</code> modules.
Therefore the accuracy of these tableaux are critical to the proper operation of <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a>.  
</p>

<p>
I don't have a way to automatically test that the data in <i>every</i> tableau is correct.  That said, I can check some of the most important ones by comparing
output of <code>step_one*()</code> solvers using them with hand coded solvers implemented using alternate reference sources.
</p>

<p>
Some of the most used RKs in history are the classical O(4) method (<code>mrkiss_erk_kutta_4</code>), Fehlberg's embedded O(4,5) method (<code>mrkiss_eerk_fehlberg_4_5</code>), and
Dormand &amp; Prince's embedded O(5,4) method (<code>mrkiss_eerk_dormand_prince_5_4</code>).  To this end the <code>mrkiss_solvers_wt</code> module contains hand written versions of
these solvers (<code>step_one_rk4_wt()</code>, <code>step_one_rkf45_wt()</code>, &amp; <code>step_one_dp54_wt()</code>). The <a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a> test suite contains
several tests related to these hand written solvers:
</p>

<ul class="org-ul">
<li><code>test_dp54</code> 
<ul class="org-ul">
<li>Make sure the hand coded results are identical with:
<ul class="org-ul">
<li>Results from <code>step_one()</code> based on the tableau in <code>lib/mrkiss_eerk_dormand_prince_5_4.f90</code>.</li>
<li>Results from <code>step_all()</code> based on the tableau in <code>lib/mrkiss_eerk_dormand_prince_5_4.f90</code>.</li>
</ul></li>
<li>Make sure results have not changed from last release.</li>
</ul></li>
<li><code>test_rkf45</code> 
<ul class="org-ul">
<li>Make sure the hand coded results are identical with:
<ul class="org-ul">
<li>Results from <code>step_one()</code> based on the tableau in <code>lib/mrkiss_eerk_fehlberg_4_5.f90</code>.</li>
<li>Results from <code>step_all()</code> based on the tableau in <code>lib/mrkiss_eerk_fehlberg_4_5.f90</code>.</li>
</ul></li>
<li>Make sure results have not changed from last release.</li>
</ul></li>
<li><code>test_rk4</code> Runs the following tests
<ul class="org-ul">
<li>Make sure the hand coded results are identical with:
<ul class="org-ul">
<li>Results from <code>step_one()</code> based on the tableau in <code>lib/mrkiss_erk_kutta_4.f90</code>.</li>
</ul></li>
<li>Make sure the hand coded results are <i>consistent</i> with computations done by hand (with a pocket calculator).</li>
<li>Make sure results have not changed from last release.</li>
</ul></li>
<li><code>test_ref</code> Make sure the hand coded results from all three solvers are consistent.</li>
</ul>
</div>
</div>
<div id="outline-container-test-mrkiss-tab-ok" class="outline-3">
<h3 id="test-mrkiss-tab-ok"><span class="section-number-3">12.2.</span> Tableau Plausibility Tests</h3>
<div class="outline-text-3" id="text-test-mrkiss-tab-ok">
<p>
In the <a href="#test-mrkiss-ref-one-step">previous section</a> we have some spot checks for three tableaux.  In this section we have tests that verify the <i>plausibility</i> of the
remaining methods.  What do I mean by "plausibility"?  I mean that we can verify that the tableaux define methods that at least seem to act like well behaved RK methods
of the appropriate order.  
</p>

<p>
These tests also serve as "change detection".  That is to say, if I change something in the code and get different results then I may have introduced a bug.
</p>

<ul class="org-ul">
<li><code>tc1_png</code> This will run the tests and display diagnostic visualizations a human can check for plausibility.  Note the <code>tc1.R</code> file contains R code that
may be useful in investigating these results.</li>
<li><code>test_tc1</code> This will compare the output of the tests to archived results in
<a href="https://github.com/richmit/MRKISS/blob/master/tests/data"><code>MRKISS/tests/data/</code></a> to detect changes.</li>
</ul>

<p>
Note these tests include about 40 individual test cases each with it's own Fortran source.  These tests are <i>generated</i> from a single seed Fortran source file
named <a href="https://github.com/richmit/MRKISS/blob/master/tests/tc1_template.f90"><code>tc1_template.f90</code></a> that is expanded into the remaining source files via the
script <a href="https://github.com/richmit/MRKISS/blob/master/tests/tc_make_make.rb"><code>tc_make_make.rb</code></a>.  All of this is handled in the make file which will
regenerate all the test source if the template is modified.
</p>

<p>
The test equation used is:
</p>

<p>
\[ \frac{\mathrm{d}y}{\mathrm{d}t} = e^\left(-t^2\right) \]
</p>

<p>
The primary diagnostic plot is of global error:
</p>


<div id="org32ba9ec" class="figure">
<p><a href="pics/tc1_plot_error.png" width="90%" align="center"><img src="pics/tc1_plot_error.png" alt="tc1_plot_error.png" width="90%" align="center" /></a>
</p>
</div>
</div>
</div>
<div id="outline-container-test-mrkiss-homo-tab-ok" class="outline-3">
<h3 id="test-mrkiss-homo-tab-ok"><span class="section-number-3">12.3.</span> Autonomous Solvers and More Tableau Plausibility Tests</h3>
<div class="outline-text-3" id="text-test-mrkiss-homo-tab-ok">
<p>
In the <a href="#test-mrkiss-tab-ok">previous section</a> we documented <i>plausibility</i> tests for the tableaux via the <code>mrkiss_solvers_wt</code> module.  This set of tests
continues that with a new test equation:
</p>

<p>
\[ \frac{\mathrm{d}y}{\mathrm{d}t} = -2y \]
</p>

<p>
For these tests we use the autonomous solvers in the <code>mrkiss_solvers_nt</code> module.  This source code for this module is entirely generated from
<a href="https://github.com/richmit/MRKISS/blob/master/lib/mrkiss_solvers_wt.f90"><code>mrkiss_solvers_wt.f90</code></a> via
<a href="https://github.com/richmit/MRKISS/blob/master/lib/wt2nt.sed"><code>wt2nt.sed</code></a>.  So these tests also serve as a way to make sure this code gets generated and
produces reasonable results.
</p>

<p>
Like the tests in the <a href="#test-mrkiss-tab-ok">previous section</a> these tests also serve as "change detection".  That is to say, if I change something in the
code and get different results then I may have introduced a bug.
</p>

<ul class="org-ul">
<li><code>tc2_png</code> This will run the tests and display diagnostic visualizations a human can check for plausibility.  Note the <code>tc2.R</code> file contains R
code that may be useful in investigating these results.</li>
<li><code>test_tc2</code> This will compare the output of the tests to archived results in <a href="https://github.com/richmit/MRKISS/blob/master/tests/data"><code>MRKISS/tests/data/</code></a> to
detect changes.</li>
</ul>

<p>
Note these tests include about 40 individual test cases each with it's own Fortran source.  These tests are <i>generated</i> from a single seed Fortran source file
named <a href="https://github.com/richmit/MRKISS/blob/master/tests/tc2_template.f90"><code>tc2_template.f90</code></a> that is expanded into the remaining source files via the
script <a href="https://github.com/richmit/MRKISS/blob/master/tests/tc_make_make.rb"><code>tc_make_make.rb</code></a>.  All of this is handled in the make file which will
regenerate all the test source if the template is modified.
</p>

<p>
The primary diagnostic plot is of global error:
</p>


<div id="orged16279" class="figure">
<p><a href="pics/tc2_plot_error.png" width="90%" align="center"><img src="pics/tc2_plot_error.png" alt="tc2_plot_error.png" width="90%" align="center" /></a>
</p>
</div>
</div>
</div>
<div id="outline-container-test-mrkiss-short" class="outline-3">
<h3 id="test-mrkiss-short"><span class="section-number-3">12.4.</span> Short Stages</h3>
<div class="outline-text-3" id="text-test-mrkiss-short">
<p>
The <code>step_one*()</code>, <code>fixed_t_steps*()</code>, <code>steps_condy*()</code>, and <code>steps_sloppy_condy*()</code> solvers all use the <code>b</code> vector to determine the number of stages &#x2013;
not the size of <code>a</code>.  This allows us to use a shorter <code>b</code> vector cutting off trailing zero entries.  This test makes sure this functionality works.
</p>

<ul class="org-ul">
<li><code>test_short_b</code> Runs the following tests
<ul class="org-ul">
<li><code>test_short_b_sub_vs_arc</code> Compare full stage results with truncated results</li>
<li><code>test_short_b_all_vs_sub</code> Compare with archived output in <a href="https://github.com/richmit/MRKISS/blob/master/tests/data"><code>MRKISS/tests/data/</code></a>.</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-test-mrkiss-examples" class="outline-3">
<h3 id="test-mrkiss-examples"><span class="section-number-3">12.5.</span> Examples Are Tests Too</h3>
<div class="outline-text-3" id="text-test-mrkiss-examples">
<p>
The <a href="https://github.com/richmit/MRKISS/blob/master/examples/tdata"><code>MRKISS/examples/tdata/</code></a> directory in
<a href="https://github.com/richmit/MRKISS/blob/master/examples"><code>MRKISS/examples/</code></a> is used to archive old output files generated from running the examples.  The
<a href="https://github.com/richmit/MRKISS/blob/master/examples/makefile"><code>makefile</code></a> contains tests to run the examples and compare the results to what was
archived.  These tests serve as "change detection" helping me to identify the introduction of bugs. All of these tests may be run with the <code>tests</code> target:
</p>

<div class="org-src-container">
<pre class="src src-makefile"><span style="color: #00fa9a; font-weight: bold;">tests</span> : test_minimal test_brusselator test_lorenz test_three_body test_step_order_vs_error
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-faq" class="outline-2">
<h2 id="faq"><span class="section-number-2">13.</span> FAQ</h2>
<div class="outline-text-2" id="text-faq">
</div>
<div id="outline-container-faq-name" class="outline-3">
<h3 id="faq-name"><span class="section-number-3">13.1.</span> What's with the name?</h3>
<div class="outline-text-3" id="text-faq-name">
<p>
It's an overlapping acronym
</p>

<p>
MRKISS =&gt; MR RK KISS =&gt; Mitch Richling's Runge-Kutta Keep It Super Simple
</p>

<p>
Having such a complex name for a super simple library amuses me&#x2026; Perhaps more than it should&#x2026;
</p>
</div>
</div>
<div id="outline-container-faq-fortran" class="outline-3">
<h3 id="faq-fortran"><span class="section-number-3">13.2.</span> Why Fortran</h3>
<div class="outline-text-3" id="text-faq-fortran">
<p>
I do most of my programming in other languages, but I really like Fortran specifically for this kind of work.  It's just good at math.  Especially when
vectors and matrices are involved.
</p>
</div>
</div>
<div id="outline-container-faq-why" class="outline-3">
<h3 id="faq-why"><span class="section-number-3">13.3.</span> Why did you write another ODE solver when so many good options exist?</h3>
<div class="outline-text-3" id="text-faq-why">
<p>
For a long time I have had a few annoyances related available packages:
</p>

<ul class="org-ul">
<li>Sharing results and code required others to install and learn a complex software tool chain.</li>
<li>Some generative art use cases drive some odd requirements that can be frustratingly difficult to do with some packages.</li>
<li>Getting tools installed on new supercomputers and HPC clusters can be a challenge.  It can even be annoying in the cloud.</li>
</ul>

<p>
Then one day I spent four hours trying to get my normal technical computing environment deployed to a new supercomputer with insufficient user privilege and a
broken user space package manager.  I wrote this library over the following weekend. ;)
</p>

<p>
In short, sometimes I just want something to work without downloading and installing gigabytes of stuff.
</p>

<p>
Oh.  And I enjoy writing this kind of code..
</p>
</div>
</div>
<div id="outline-container-faq-others" class="outline-3">
<h3 id="faq-others"><span class="section-number-3">13.4.</span> Why don't you use package XYZ?</h3>
<div class="outline-text-3" id="text-faq-others">
<p>
Don't get me wrong, I <b>do</b> use other packages!
</p>

<p>
One of my favorites is <a href="https://www.mitchr.me/SS/tools/index.html#imath-inla">Julia</a>'s <code>DifferentialEquations.jl</code>.  For bare-metal, I'm quite fond of
<a href="https://www.mitchr.me/SS/tools/index.html#lib-sci">SUNDIALS</a>.  I also find myself using higher level tools like
<a href="https://www.mitchr.me/SS/tools/index.html#stats">R</a>, <a href="https://www.mitchr.me/SS/tools/index.html#imath-inla">MATLAB/Octave</a>, and
<a href="https://www.mitchr.me/SS/tools/index.html#imath-gcas">Maple/Maxima</a>.
</p>
</div>
</div>
<div id="outline-container-faq-zotero" class="outline-3">
<h3 id="faq-zotero"><span class="section-number-3">13.5.</span> What are those zotero links in the references?</h3>
<div class="outline-text-3" id="text-faq-zotero">
<p>
Zotero is a bibliography tool.  On my computer, those links take me to the Zotero application with the reference in question highlighted.  This allows
me to see the full bibliography entry and related documents (like personal notes, etc&#x2026;).
</p>

<p>
Unfortunately they are not of much use to anyone but me.
</p>
</div>
</div>
<div id="outline-container-faq-samethods" class="outline-3">
<h3 id="faq-samethods"><span class="section-number-3">13.6.</span> Are high order RK methods overkill for strange attractors?</h3>
<div class="outline-text-3" id="text-faq-samethods">
<p>
Yes.  In fact, Euler's method is normally good enough for strange attractors.
</p>
</div>
</div>
<div id="outline-container-faq-need-more" class="outline-3">
<h3 id="faq-need-more"><span class="section-number-3">13.7.</span> I need a more comprehensive solution.  Do you have advice?</h3>
<div class="outline-text-3" id="text-faq-need-more">
<p>
My favorite is <a href="https://www.mitchr.me/SS/tools/index.html#imath-inla">Julia</a>'s <code>DifferentialEquations.jl</code>.  It is comprehensive, well designed, fast, and
pretty easy to use.
</p>

<p>
If you are looking for something you can call from C, C++, or Fortran then my first choice is <a href="https://www.mitchr.me/SS/tools/index.html#lib-sci">SUNDIALS</a>.
</p>

<p>
The <code>ode*</code> set of commands in <a href="https://www.mitchr.me/SS/tools/index.html#imath-inla">MATLAB/Octave</a> are easy to use, work well, and are extensively
documented.  In addition, Octave has <code>lsode</code> built-in which is pretty cool.
</p>

<p>
<a href="https://www.mitchr.me/SS/tools/index.html#imath-gcas">Maple</a> has a good selection of numerical solvers, a well designed interface, and rich ODE related
graphics.  It also has some of the best symbolic ODE capabilities available.
</p>

<p>
If you are doing statistics in combination with ODEs, then <a href="https://www.mitchr.me/SS/tools/index.html#stats">R</a> is a fantastic choice.
</p>
</div>
</div>
<div id="outline-container-faq-need-fast" class="outline-3">
<h3 id="faq-need-fast"><span class="section-number-3">13.8.</span> I need something faster.  Do you have advice?</h3>
<div class="outline-text-3" id="text-faq-need-fast">
<p>
All of the options listed for the question "<a href="#faq-need-more">I need a more comprehensive solution.  Do you have
advice?</a>" are faster than <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b>.  In particular <a href="https://www.mitchr.me/SS/tools/index.html#imath-inla">Julia</a>'s
<code>DifferentialEquations.jl</code> and <a href="https://www.mitchr.me/SS/tools/index.html#lib-sci">SUNDIALS</a>.
</p>

<p>
If you are looking for something small without a lot of dependencies, then you might like <a href="https://www.unige.ch/~hairer/software.html">Hairer's classic
codes</a> &#x2013; they are faster than <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b>.
</p>
</div>
</div>
<div id="outline-container-faq-deps" class="outline-3">
<h3 id="faq-deps"><span class="section-number-3">13.9.</span> It seems like things are used other than Fortran.  Are there really no external dependencies?</h3>
<div class="outline-text-3" id="text-faq-deps">
<p>
I use several tools in the <b>development</b> of <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b>.  In addition several of the examples use external tools to draw
graphs.  None of these tools are required to compile and use the package because I have included all the generated code in the repository.  Here is a summary:
</p>

<dl class="org-dl">
<dt>POSIX shell (<code>sh</code>)</dt><dd><ul class="org-ul">
<li>Generate <code>step_one_wt</code> from <code>step_one_wt</code> in <code>mrkiss_solvers_wt.f90</code>.</li>
<li>Some makefile constructs for code generation, plotting, testing, etc&#x2026;</li>
</ul></dd>
<dt>sed</dt><dd><ul class="org-ul">
<li>Generate <code>step_one_wt</code> from <code>step_one_wt</code> in <code>mrkiss_solvers_wt.f90</code>.</li>
<li>Generate <code>mrkiss_solvers_nt.f90</code> from <code>mrkiss_solvers_wt.f90</code>.</li>
</ul></dd>
<dt>ruby</dt><dd><ul class="org-ul">
<li>Generate code and make files for testing</li>
<li>My <code>float_diff.rb</code> script, used by the tests.</li>
</ul></dd>
<dt>R</dt><dd><ul class="org-ul">
<li>Visualize output files</li>
</ul></dd>
<dt>GNUplot</dt><dd><ul class="org-ul">
<li>Visualize output files</li>
</ul></dd>
<dt>Maple</dt><dd><ul class="org-ul">
<li>Butcher tableau computations.</li>
</ul></dd>
<dt>nomacs</dt><dd><ul class="org-ul">
<li>Display images</li>
</ul></dd>
<dt>ImageMagick</dt><dd><ul class="org-ul">
<li>Process and/or convert image files</li>
</ul></dd>
<dt>Doxygen</dt><dd><ul class="org-ul">
<li>Generate API documentation</li>
</ul></dd>
<dt>LaTeX</dt><dd><ul class="org-ul">
<li>Generate logo images</li>
</ul></dd>
<dt>ghostscript</dt><dd><ul class="org-ul">
<li>Generate logo images</li>
</ul></dd>
<dt>rsync</dt><dd><ul class="org-ul">
<li>Deploy doxygen documentation to my web site</li>
</ul></dd>
</dl>
</div>
</div>
<div id="outline-container-faq-rel-head" class="outline-3">
<h3 id="faq-rel-head"><span class="section-number-3">13.10.</span> What is a "Release"?  How is it different from what's on <code>HEAD</code>?</h3>
<div class="outline-text-3" id="text-faq-rel-head">
<p>
Releases are contained in commits with a tag that looks like this: "vYYYY-MM-DD" &#x2013; i.e. an ISO 8601 format date prefixed with the letter "v".  These commits
differ from other commits in terms of quality control.  Release commits:
</p>
<ul class="org-ul">
<li>Unit tests are all successful.  For information on platforms tested, see <a href="#faq-rel-platforms">What platforms are known to work?</a>.</li>
<li>Development documentation (changelog &amp; roadmap) are both up to date.</li>
<li>Example documentation is newer than the corresponding example source.</li>
<li>Doxygen documentation
<ul class="org-ul">
<li>Has been generated after the most recently modified source code file.</li>
<li>Has a version number that matches the tag.</li>
<li>Has been deployed to by web site.</li>
</ul></li>
<li>The repository is clean.</li>
<li>The manifest file 
<ul class="org-ul">
<li>Newer than all source code files</li>
<li>Checksums match what is in repository</li>
<li>It's checked into git</li>
</ul></li>
</ul>

<p>
That said, I generally try to only push working code to github so <code>HEAD</code> should be reasonably safe.  You can see what changes have been made on <code>HEAD</code>
by taking a look at the <a href="https://richmit.github.io/MRKISS/changelog.html#latest">latest changelog section</a>.
</p>
</div>
</div>
<div id="outline-container-faq-rel-platforms" class="outline-3">
<h3 id="faq-rel-platforms"><span class="section-number-3">13.11.</span> What platforms are known to work?</h3>
<div class="outline-text-3" id="text-faq-rel-platforms">
<p>
I have used <b><a href="https://github.com/richmit/MRKISS"><code>MRKISS</code></a></b> on a variety of platforms including:
</p>
<ul class="org-ul">
<li>Various supercomputers and HPC platforms.</li>
<li>Cloud hosted linux systems using various distributions: RH, SuSE, Debian, Ubuntu, &amp; Arch.</li>
</ul>

<p>
When performing a release I test on my primary development system which changes over time.  Below are the platforms I tested for each release:
</p>

<ul class="org-ul">
<li><code>2025-08-12</code>
<ul class="org-ul">
<li>Microsoft Windows 11 Pro 10.0.26100 Build 26100 running MSYS2
<ul class="org-ul">
<li>GNU Fortran (Rev6, Built by MSYS2 project) 15.1.0</li>
<li>Intel(R) Fortran Compiler for applications running on Intel(R) 64, Version 2024.1.0 Build 20240308</li>
<li>flang version 20.1.7 x86_64-w64-windows-gnu posix (lorenz_test fails, but it's OK.)</li>
</ul></li>
<li>Debian 13.0
<ul class="org-ul">
<li>GNU Fortran (Debian 14.2.0-19) 14.2.0</li>
<li>ifx (IFX) 2025.0.4 20241205 (lorenz_test fails, but it's OK.)</li>
<li>Debian flang-new version 19.1.7 (3) x86_64-pc-linux-gnu posix (lorenz_test fails, but it's OK.)</li>
</ul></li>
</ul></li>
<li><code>2025-08-10</code>
<ul class="org-ul">
<li>Microsoft Windows 11 Pro 10.0.26100 Build 26100 running MSYS2
<ul class="org-ul">
<li>GNU Fortran (Rev6, Built by MSYS2 project) 15.1.0</li>
<li>Intel(R) Fortran Compiler for applications running on Intel(R) 64, Version 2024.1.0 Build 20240308</li>
<li>flang version 20.1.7 x86_64-w64-windows-gnu posix (lorenz_test fails, but it's OK.)</li>
</ul></li>
<li>Debian 13.0
<ul class="org-ul">
<li>GNU Fortran (Debian 14.2.0-19) 14.2.0</li>
<li>ifx (IFX) 2025.0.4 20241205 (lorenz_test fails, but it's OK.)</li>
<li>Debian flang-new version 19.1.7 (3) x86_64-pc-linux-gnu posix (lorenz_test fails, but it's OK.)</li>
</ul></li>
</ul></li>
<li><code>v2025-08-08</code>
<ul class="org-ul">
<li>Microsoft Windows 11 Pro 10.0.26100 Build 26100 running MSYS2
<ul class="org-ul">
<li>GNU Fortran (Rev6, Built by MSYS2 project) 15.1.0</li>
<li>Intel(R) Fortran Compiler for applications running on Intel(R) 64, Version 2024.1.0 Build 20240308</li>
<li>flang version 20.1.7 x86_64-w64-windows-gnu posix (lorenz_test fails, but it's OK.)</li>
</ul></li>
<li>Debian 13.0
<ul class="org-ul">
<li>GNU Fortran (Debian 14.2.0-19) 14.2.0</li>
<li>nvfortran 24.11-0 64-bit target on x86-64 Linux -tp tigerlake (requires reformatting the code to line length limitations)</li>
<li>ifx (IFX) 2025.0.4 20241205 (lorenz_test fails, but it's OK.)</li>
<li>Debian flang-new version 19.1.7 (3) x86_64-pc-linux-gnu posix (lorenz_test fails, but it's OK.)</li>
</ul></li>
</ul></li>
<li><code>v2025-08-04</code>
<ul class="org-ul">
<li>Microsoft Windows 11 Pro 10.0.26100 Build 26100 running MSYS2
<ul class="org-ul">
<li>GNU Fortran (Rev6, Built by MSYS2 project) 15.1.0</li>
<li>Intel(R) Fortran Compiler for applications running on Intel(R) 64, Version 2024.1.0 Build 20240308</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
</div>
</body>
</html>
